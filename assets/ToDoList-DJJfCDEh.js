import{_ as z,r as v,i as R,j as Z,c as d,m as i,a as e,n as x,k as D,N as k,t as c,w as L,v as $,d as w,F as V,b as B,g,D as q,o as a,u as p,p as G,x as y,f as T,q as W,s as H,y as I,z as J,A as Q,B as X,E as Y,G as tt,C as et}from"./index-BO8SMRu3.js";import{F as st}from"./FullScreenLoading-DIQ2zAxG.js";import{w as ot,s as b,e as nt}from"./index-DdF8-771.js";const at={id:"todoListPage",class:"bg-half flex flex-col"},lt={class:"todo_sm"},it={class:"container todoListPage flex-1 min-h-0"},rt={class:"todoList_Content flex flex-col h-full min-h-0"},ut={class:"inputBox shrink-0"},dt={class:"todoList_list flex flex-col flex-1 min-h-0 overflow-hidden"},ct={class:"todoList_tab shrink-0"},pt=["onClick"],ft={class:"todoList_items overflow-auto flex-1 min-h-0"},vt={class:"todoList_item"},_t={class:"todoList_label mr-2"},ht=["onUpdate:modelValue","onChange"],mt={class:"flex-1 items-end justify-between"},xt=["onKeyup","onUpdate:modelValue"],gt={key:1,class:"flex justify-between"},kt={key:0,class:"flex gap-2 text-xl mr-3 pb-4"},yt={class:"flex justify-end p-3 shadow-[0_-4px_15px_0_rgba(0,0,0,0.1)]"},Ct={class:"my-2"},Lt={__name:"ToDoList",setup(wt){const U=v(sessionStorage.getItem("nickname")||"Not User"),F=v(!1),r=o=>F.value=o,M=()=>{},j=[{label:"全部",state:"all",textColor:"text-blue-600"},{label:"待完成",state:"now",textColor:"text-red-600"},{label:"已完成",state:"done",textColor:"text-green-600"}],u=v("now"),E=R(()=>(l.value.sort((o,s)=>o.status-s.status),u.value==="all"?l.value:u.value==="done"?l.value.filter(o=>o.status):l.value.filter(o=>!o.status))),_=v(null),K=o=>{_.value=o},S=o=>{r(!0),tt(o.id,{content:o.content}).then(()=>b({title:"更新成功！"})).then(()=>m()).finally(()=>{_.value=null,r(!1)})},h=v(""),C=()=>{if(h.value===""){ot({title:"請填寫內容！"});return}r(!0),Y({content:h.value}).then(()=>b({title:"新增成功！"}).then(()=>{h.value="",m()})).catch(o=>nt({title:"新增失敗",text:o?.response?.data?.message??"請稍後再試！",showCancelButton:!1})).finally(()=>r(!1))},l=v([]),m=()=>{r(!0),q().then(o=>{l.value=o.data.data}).finally(()=>{r(!1)})},O=o=>{if(o==null)return"";const s=Number(o);if(Number.isNaN(s))return"";const f=Math.abs(s)<1e12?s*1e3:s,t=new Date(f),A=new Intl.DateTimeFormat("zh-TW",{timeZone:"Asia/Taipei",hour12:!1,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}).format(t).replaceAll("/","-"),P=new Intl.DateTimeFormat("en-US",{timeZone:"Asia/Taipei",weekday:"short"}).format(t).toLowerCase();return`${A} (${P})`};return Z(()=>{m()}),(o,s)=>{const N=D("RouterLink"),f=D("el-icon");return a(),d("div",at,[i(st,{isLoading:F.value},null,8,["isLoading"]),e("nav",null,[e("h1",null,[i(N,{to:"/",title:"回到主頁面"},{default:x(()=>[...s[5]||(s[5]=[g("ONLINE TODO LIST",-1)])]),_:1})]),e("ul",null,[e("li",lt,[e("a",{href:"",onClick:s[0]||(s[0]=k(()=>{},["prevent"]))},[e("span",null,c(U.value)+"的代辦",1)])]),e("li",null,[e("a",{href:"",onClick:k(M,["prevent"])},"登出 ")])])]),e("div",it,[e("div",rt,[e("div",ut,[L(e("input",{type:"text","onUpdate:modelValue":s[1]||(s[1]=t=>h.value=t),onKeyup:w(C,["enter"]),placeholder:"請輸入待辦事項"},null,544),[[$,h.value]]),e("a",{href:"",onClick:k(C,["prevent"]),class:"flex justify-center items-center"},[i(f,{class:"top-[-3px]"},{default:x(()=>[i(p(G))]),_:1})])]),e("div",dt,[e("ul",ct,[(a(),d(V,null,B(j,t=>e("li",{key:t.state},[e("a",{href:"",onClick:k(n=>u.value=t.state,["prevent"]),class:y([{active:u.value===t.state},t.textColor])},c(t.label),11,pt)])),64))]),e("div",ft,[e("ul",vt,[(a(!0),d(V,null,B(E.value,t=>(a(),d("li",{key:t.id},[e("label",_t,[L(e("input",{class:"todoList_input","onUpdate:modelValue":n=>t.status=n,type:"checkbox",onKeyup:w(C,["enter"]),onChange:n=>{r(!0),p(H)(t.id).then(m)}},null,40,ht),[[W,t.status]]),e("div",mt,[_.value===t.id?L((a(),d("input",{key:0,type:"text",onKeyup:w(n=>S(t),["enter"]),"onUpdate:modelValue":n=>t.content=n,class:y(["border p-1 rounded-md",{"line-through text-gray-500":t.status}])},null,42,xt)),[[$,t.content]]):(a(),d("div",gt,[e("span",{class:y({"line-through text-gray-500":t.status})},c(t.content),3),e("span",{class:y(["text-[12px] text-gray-600 ml-2",{"line-through text-gray-500":t.status}])},c(O(t.createTime)),3)]))])]),t.status?T("",!0):(a(),d("div",kt,[_.value===null?(a(),I(f,{key:0,color:"#165DFF",class:"cursor-pointer",onClick:n=>K(t.id)},{default:x(()=>[i(p(J))]),_:2},1032,["onClick"])):T("",!0),_.value===t.id?(a(),I(f,{key:1,onClick:n=>S(t),color:"#00C851",class:"cursor-pointer"},{default:x(()=>[i(p(Q))]),_:2},1032,["onClick"])):T("",!0),i(f,{color:"#FF3B30",class:"cursor-pointer",onClick:n=>p(et)(t.id).then(()=>{p(b)({title:"刪除成功！"}).then(()=>{m()})})},{default:x(()=>[i(p(X))]),_:2},1032,["onClick"])]))]))),128))])]),e("div",yt,[e("p",Ct,[s[6]||(s[6]=g(" 共有 ",-1)),e("span",{class:"text-blue-600 cursor-pointer",onClick:s[2]||(s[2]=t=>u.value="all")},c(l.value.length),1),s[7]||(s[7]=g(" 項代辦事項，待完成 ",-1)),e("span",{class:"text-red-600 cursor-pointer",onClick:s[3]||(s[3]=t=>u.value="now")},c(l.value.filter(t=>!t.status).length),1),s[8]||(s[8]=g(" 項，已完成 ",-1)),e("span",{class:"text-green-600 cursor-pointer",onClick:s[4]||(s[4]=t=>u.value="done")},c(l.value.filter(t=>t.status).length),1),s[9]||(s[9]=g(" 項代辦事項！ ",-1))])])])])])])}}},Nt=z(Lt,[["__scopeId","data-v-2dd60f5e"]]);export{Nt as default};
