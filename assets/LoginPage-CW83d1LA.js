import{_ as J,c as q,o as T,a as p,f as Q,t as L,F as A,K as ne,r as _,i as se,e as ie,m as W,n as oe,k as le,L as ue,b as de,u as x,g as ce,l as me,M as fe,h as ve,y as pe}from"./index-B2nYcRD0.js";import{s as D,e as be,w as ge}from"./index-D6qEvwj7.js";import{F as ke}from"./FullScreenLoading-B3OAFDBg.js";import{r as he,a as ye,b as we,c as Y}from"./isObjectLike-DXDPz1WO.js";const xe=["for"],Te=["value","type","id","name","placeholder","required"],Ce={key:0,class:"text-red-500"},Ie={__name:"TextInput",props:{modelValue:{type:String,default:""},label:{type:String,default:"姓名"},labelKey:{type:String,default:"key"},type:{type:String,default:"text"},required:{type:Boolean,default:!1},error:{type:Boolean,default:!1},errorText:{type:String,default:"格式錯誤"}},emits:["update:input","update:change"],setup(r,{emit:u}){return(t,s)=>(T(),q(A,null,[p("label",{class:"formControls_label",for:r.labelKey},L(r.label),9,xe),p("input",{class:"formControls_input",value:r.modelValue,type:r.type,id:r.labelKey,name:r.labelKey,placeholder:"請輸入"+r.label,onInput:s[0]||(s[0]=m=>t.$emit("update:input",m.target.value)),required:r.required,onChange:s[1]||(s[1]=m=>t.$emit("updata:change",r.labelKey))},null,40,Te),r.error?(T(),q("span",Ce,L(r.errorText),1)):Q("",!0)],64))}},Se=J(Ie,[["__scopeId","data-v-71ec058e"]]);var N,P;function _e(){if(P)return N;P=1;var r=he(),u=function(){return r.Date.now()};return N=u,N}var B,z;function qe(){if(z)return B;z=1;var r=/\s/;function u(t){for(var s=t.length;s--&&r.test(t.charAt(s)););return s}return B=u,B}var $,Z;function Le(){if(Z)return $;Z=1;var r=qe(),u=/^\s+/;function t(s){return s&&s.slice(0,r(s)+1).replace(u,"")}return $=t,$}var O,G;function Ee(){if(G)return O;G=1;var r=ye(),u=we(),t="[object Symbol]";function s(m){return typeof m=="symbol"||u(m)&&r(m)==t}return O=s,O}var K,H;function Re(){if(H)return K;H=1;var r=Le(),u=Y(),t=Ee(),s=NaN,m=/^[-+]0x[0-9a-f]+$/i,C=/^0b[01]+$/i,n=/^0o[0-7]+$/i,c=parseInt;function d(e){if(typeof e=="number")return e;if(t(e))return s;if(u(e)){var v=typeof e.valueOf=="function"?e.valueOf():e;e=u(v)?v+"":v}if(typeof e!="string")return e===0?e:+e;e=r(e);var g=C.test(e);return g||n.test(e)?c(e.slice(2),g?2:8):m.test(e)?s:+e}return K=d,K}var V,X;function Ne(){if(X)return V;X=1;var r=Y(),u=_e(),t=Re(),s="Expected a function",m=Math.max,C=Math.min;function n(c,d,e){var v,g,w,b,f,k,a=0,i=!1,h=!1,l=!0;if(typeof c!="function")throw new TypeError(s);d=t(d)||0,r(e)&&(i=!!e.leading,h="maxWait"in e,w=h?m(t(e.maxWait)||0,d):w,l="trailing"in e?!!e.trailing:l);function I(o){var y=v,S=g;return v=g=void 0,a=o,b=c.apply(S,y),b}function ee(o){return a=o,f=setTimeout(E,d),i?I(o):b}function te(o){var y=o-k,S=o-a,U=d-y;return h?C(U,w-S):U}function F(o){var y=o-k,S=o-a;return k===void 0||y>=d||y<0||h&&S>=w}function E(){var o=u();if(F(o))return M(o);f=setTimeout(E,te(o))}function M(o){return f=void 0,l&&v?I(o):(v=g=void 0,b)}function ae(){f!==void 0&&clearTimeout(f),a=0,v=k=g=f=void 0}function re(){return f===void 0?b:M(u())}function R(){var o=u(),y=F(o);if(v=arguments,g=this,k=o,y){if(f===void 0)return ee(k);if(h)return clearTimeout(f),f=setTimeout(E,d),I(k)}return f===void 0&&(f=setTimeout(E,d)),b}return R.cancel=ae,R.flush=re,R}return V=n,V}var Be=Ne();const j=ne(Be),$e={id:"loginPage",class:"bg-yellow"},Oe={class:"container loginPage h-screen"},Ke={class:"side"},Ve={class:"formControls_txt"},je=["value"],Ae={class:"formControls_btnLink"},Fe={__name:"LoginPage",setup(r){const u=fe(),t=_(!0),s=_(!1),m=a=>s.value=a,C=se(()=>[{label:"Email",key:"email",type:"email",required:!0,show:!0},{label:"暱稱",key:"nickname",type:"text",required:!1,show:!t.value},{label:"密碼",key:"password",type:"password",required:!0,show:!0},{label:"再次輸入密碼",key:"passwordCheck",type:"password",required:!1,show:!t.value}]),n=_({email:"",nickname:"",password:"",passwordCheck:""}),c=_({email:!1,nickname:!1,password:!1,passwordCheck:!1}),d=_({email:"格式錯誤",nickname:"格式錯誤",password:"格式錯誤",passwordCheck:"與密碼不符"}),e=()=>{n.value={email:n.value.email,nickname:"",password:"",passwordCheck:""}},v=()=>{m(!0),t.value?me({email:n.value.email,password:n.value.password}).then(a=>{sessionStorage.setItem("token",a.data?.token),sessionStorage.setItem("nickname",a.data?.nickname),D({title:"登入成功！"}).then(()=>{n.value={email:"",password:"",nickname:""},u.push("/final-todo-list/to-do-list")})}).catch(a=>{be({text:a?.response?.data?.message??"請稍後再試",confirmButtonText:"前往註冊",cancelButtonText:"我再想想"}).then(i=>{if(i.isConfirmed){t.value=!1,e();return}})}).finally(()=>m(!1)):ve({email:n.value.email,password:n.value.password,nickname:n.value.nickname}).then(()=>{D({title:"註冊成功！",confirmButtonText:"點我登入"}).then(()=>{t.value=!0,e()})}).catch(a=>{ge({title:"註冊失敗！",text:a?.response?.data?.message??"請稍後再試！",confirmButtonText:"重新輸入"}).then(()=>{n.value={email:n.value.email,password:"",nickname:n.value.nickname}})}).finally(()=>m(!1))},g=j((a,i)=>{f(a,i)},300),w=j(a=>{k(a)},300),b=j(()=>{v()},300),f=(a,i)=>{n.value[a]=i},k=a=>{console.log("type",a);const i=/^[\w-]+(\.[\w-]+)*@([\w-]+\.)+[a-zA-Z]{2,7}$/,h=/^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d]{6,20}$/;if(a==="email"){c.value.email=!i.test(n.value.email),c.value.email&&(d.value.email="請輸入正確的 Email 格式");return}if(a==="nickname"){c.value.nickname=n.value.nickname.length<1||n.value.nickname.length>20,c.value.nickname&&(d.value.nickname="暱稱長度需介於1~20字元");return}if(a==="password"){c.value.password=!h.test(n.value.password),c.value.password&&(d.value.password="密碼需包含英文及數字，長度6~20字元");return}if(a==="passwordCheck"&&!t.value){c.value.passwordCheck=n.value.password!==n.value.passwordCheck,c.value.passwordCheck&&(d.value.passwordCheck="兩次密碼不相符，請重新確認");return}};return ie(t,()=>{c.value={nickname:!1,password:!1,passwordCheck:!1},e(),n.value.email!==""&&k("email")}),(a,i)=>{const h=le("RouterLink");return T(),q("div",$e,[W(ke,{isLoading:s.value},null,8,["isLoading"]),p("div",Oe,[p("div",Ke,[W(h,{to:"/",title:"回到主頁面"},{default:oe(()=>[...i[3]||(i[3]=[p("img",{class:"logoImg",src:"https://raw.githubusercontent.com/hexschool/2022-web-layout-training/main/todolist/logo.png",alt:""},null,-1)])]),_:1}),i[4]||(i[4]=p("img",{class:"d-m-n",src:"https://raw.githubusercontent.com/hexschool/2022-web-layout-training/main/todolist/img.png",alt:"workImg"},null,-1))]),p("div",null,[p("form",{class:"formControls",onSubmit:i[2]||(i[2]=ue((...l)=>x(b)&&x(b)(...l),["prevent"]))},[p("h2",Ve,L(t.value?"最實用的線上待辦事項服務":"註冊帳號"),1),(T(!0),q(A,null,de(C.value,l=>(T(),q(A,{key:l.key},[l.show?(T(),pe(Se,{key:0,modelValue:n.value[l.key],label:l.label,type:l.key,labelKey:l.key,"onUpdate:input":I=>x(g)(l.key,I),required:"",error:c.value[l.key],errorText:d.value[l.key],"onUpdata:change":x(w)},null,8,["modelValue","label","type","labelKey","onUpdate:input","error","errorText","onUpdata:change"])):Q("",!0)],64))),128)),p("input",{class:"formControls_btnSubmit",type:"submit",onClick:i[0]||(i[0]=(...l)=>x(b)&&x(b)(...l)),value:t.value?"登入":"註冊帳號"},null,8,je),p("p",Ae,[ce(L(t.value?"沒":"已")+"有帳號？ ",1),p("a",{onClick:i[1]||(i[1]=l=>t.value=!t.value),class:"text-blue-800 hover:text-blue-500 cursor-pointer"},"點我"+L(t.value?"註冊":"登入"),1)])],32)])])])}}},Pe=J(Fe,[["__scopeId","data-v-2cf0b670"]]);export{Pe as default};
